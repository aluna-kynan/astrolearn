(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[190],{63:(e,t,s)=>{"use strict";var r=s(7260);s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},846:(e,t,s)=>{"use strict";s.d(t,{GameProvider:()=>c,I:()=>i});var r=s(5155),a=s(2115);let l={playerName:"",selectedTopicId:null,topicTitle:"",selectedQuestions:10,selectedDifficulty:"easy",selectedSpaceship:null,currentQuestionIndex:0,score:0,correctAnswers:0,questions:[],miniGamesCompleted:0,gameStats:{hits:0,asteroidsDestroyed:0,gameScore:0,bossDestroyed:!1,success:!1}},n=(0,a.createContext)(void 0);function c(e){let{children:t}=e,[s,c]=(0,a.useState)(l),[i,u]=(0,a.useState)(!1),o=(0,a.useCallback)(()=>{u(!0)},[]),d=(0,a.useCallback)(()=>{setTimeout(()=>u(!1),300)},[]),m=(0,a.useCallback)(()=>{c(l)},[]);return(0,r.jsx)(n.Provider,{value:{gameState:s,setGameState:c,isLoading:i,showLoading:o,hideLoading:d,resetGame:m},children:t})}function i(){let e=(0,a.useContext)(n);if(void 0===e)throw Error("useGame must be used within a GameProvider");return e}},3126:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(5155),a=s(2115),l=s(63),n=s(846),c=s(5620);function i(){var e,t;let s=(0,l.useRouter)(),{gameState:i,resetGame:u,showLoading:o,hideLoading:d}=(0,n.I)(),[m,p]=(0,a.useState)(1);(0,a.useEffect)(()=>{d()},[d]),(0,a.useEffect)(()=>{let e=(0,c.PL)();if(e){let t=[...(0,c.bj)()].sort((e,t)=>t.score-e.score).findIndex(t=>t.id===e.id)+1;p(t>0?t:1)}},[]),(0,a.useEffect)(()=>{i.playerName||s.push("/")},[i.playerName,s]);let h=(()=>{switch(i.selectedQuestions){case 5:return 20;case 10:default:return 10;case 20:return 5}})(),f=i.correctAnswers*h;return(0,r.jsx)("section",{id:"screen-results",className:"screen active",children:(0,r.jsxs)("div",{className:"results-wrapper",children:[(0,r.jsxs)("div",{className:"result-top-card",children:[(null==(e=i.selectedSpaceship)?void 0:e.image)&&(0,r.jsx)("img",{src:i.selectedSpaceship.image,alt:"Spaceship",id:"result-character-img",className:"result-spaceship-img"}),(0,r.jsxs)("div",{className:"result-top-info",children:[(0,r.jsx)("p",{className:"result-pilot-name",id:"result-name-display",children:i.playerName||"-"}),(0,r.jsx)("p",{className:"result-ship-name",id:"result-ship",children:(null==(t=i.selectedSpaceship)?void 0:t.name)||"-"})]})]}),(0,r.jsxs)("div",{className:"result-stats-row",children:[(0,r.jsxs)("div",{className:"result-stat-card rank-card",children:[(0,r.jsxs)("div",{className:"rank-display",children:[(0,r.jsx)("span",{className:"trophy-icon",children:"\uD83C\uDFC6"}),(0,r.jsxs)("span",{className:"result-stat-value rank-value",children:[m,(0,r.jsx)("sup",{children:(e=>{let t=["th","st","nd","rd"],s=e%100;return t[(s-20)%10]||t[s]||t[0]})(m)})]})]}),(0,r.jsx)("span",{className:"result-stat-label",children:"Rank"})]}),(0,r.jsxs)("div",{className:"result-stat-card",children:[(0,r.jsx)("span",{className:"result-stat-value",id:"result-score",children:f}),(0,r.jsx)("span",{className:"result-stat-label",children:"Score"})]}),(0,r.jsxs)("div",{className:"result-stat-card",children:[(0,r.jsxs)("span",{className:"result-stat-value",children:[(0,r.jsx)("span",{id:"result-correct",children:i.correctAnswers}),"/",(0,r.jsx)("span",{id:"result-total",children:i.selectedQuestions})]}),(0,r.jsx)("span",{className:"result-stat-label",children:"Correct"})]})]}),(0,r.jsx)("button",{className:"btn-home",onClick:()=>{(0,c.Sx)(),localStorage.removeItem("cosmicquest_joined_game_code"),u(),o(),setTimeout(()=>{s.push("/"),d()},500)},children:(0,r.jsx)("span",{children:"HOME"})})]})})}},5620:(e,t,s)=>{"use strict";s.d(t,{B3:()=>i,Ip:()=>u,PL:()=>S,PN:()=>x,S0:()=>o,Sx:()=>v,TT:()=>l,aH:()=>g,bX:()=>m,bj:()=>p,hP:()=>n,i1:()=>f,tY:()=>d,zf:()=>N});let r="cosmicquest_game_session",a="cosmicquest_session_players";function l(e,t,s,l,n,c){let i={gameCode:e,hostName:t,topicId:s,topicTitle:l,selectedQuestions:n,difficulty:c,status:"waiting",createdAt:Date.now(),startedAt:null};return localStorage.setItem(r,JSON.stringify(i)),localStorage.setItem(a,JSON.stringify([])),i}function n(){let e=localStorage.getItem(r);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}function c(e){let t=n();if(!t)return null;let s={...t,...e};return localStorage.setItem(r,JSON.stringify(s)),s}function i(){return c({status:"playing",startedAt:Date.now()})}function u(){return c({status:"finished"})}function o(){localStorage.removeItem(r),localStorage.removeItem(a)}function d(e){let t=n();return t&&t.gameCode===e?t:null}function m(e,t,s){let r=d(e);if(!r)return null;let a=p(),l=a.find(e=>e.username===t);if(l)return l.spacecraft=s,h(a),l;let n={id:"player-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),username:t,spacecraft:s,progress:0,questionsAnswered:0,totalQuestions:r.selectedQuestions,score:0,isHost:!1,joinedAt:Date.now()};return a.push(n),h(a),n}function p(){let e=localStorage.getItem(a);if(!e)return[];try{return JSON.parse(e)}catch(e){return[]}}function h(e){localStorage.setItem(a,JSON.stringify(e))}function f(e,t,s,r){let a=p(),l=a.findIndex(t=>t.id===e);-1!==l&&(a[l]={...a[l],progress:t,questionsAnswered:s,score:r},h(a))}function N(e,t){let s=p(),r=s.findIndex(t=>t.id===e);-1!==r&&(s[r].spacecraft=t,h(s))}function g(){let e=n();return null!==e&&"playing"===e.status}function S(){let e=localStorage.getItem("cosmicquest_current_player");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}function x(e){localStorage.setItem("cosmicquest_current_player",JSON.stringify(e))}function v(){localStorage.removeItem("cosmicquest_current_player")}},6564:(e,t,s)=>{Promise.resolve().then(s.bind(s,3126))}},e=>{e.O(0,[441,255,358],()=>e(e.s=6564)),_N_E=e.O()}]);