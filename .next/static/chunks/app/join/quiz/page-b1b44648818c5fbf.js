(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[997],{63:(e,t,s)=>{"use strict";var n=s(7260);s.o(n,"usePathname")&&s.d(t,{usePathname:function(){return n.usePathname}}),s.o(n,"useRouter")&&s.d(t,{useRouter:function(){return n.useRouter}})},846:(e,t,s)=>{"use strict";s.d(t,{GameProvider:()=>u,I:()=>l});var n=s(5155),r=s(2115);let i={playerName:"",selectedTopicId:null,topicTitle:"",selectedQuestions:10,selectedDifficulty:"easy",selectedSpaceship:null,currentQuestionIndex:0,score:0,correctAnswers:0,questions:[],miniGamesCompleted:0,gameStats:{hits:0,asteroidsDestroyed:0,gameScore:0,bossDestroyed:!1,success:!1}},c=(0,r.createContext)(void 0);function u(e){let{children:t}=e,[s,u]=(0,r.useState)(i),[l,a]=(0,r.useState)(!1),o=(0,r.useCallback)(()=>{a(!0)},[]),d=(0,r.useCallback)(()=>{setTimeout(()=>a(!1),300)},[]),m=(0,r.useCallback)(()=>{u(i)},[]);return(0,n.jsx)(c.Provider,{value:{gameState:s,setGameState:u,isLoading:l,showLoading:o,hideLoading:d,resetGame:m},children:t})}function l(){let e=(0,r.useContext)(c);if(void 0===e)throw Error("useGame must be used within a GameProvider");return e}},1061:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s(5155),r=s(2115),i=s(63),c=s(846),u=s(5620);function l(){let e=(0,i.useRouter)(),{gameState:t,setGameState:s,showLoading:l,hideLoading:a}=(0,c.I)(),[o,d]=(0,r.useState)(null),[m,f]=(0,r.useState)(null),[h,g]=(0,r.useState)(!1),[p,x]=(0,r.useState)(!1),[S,N]=(0,r.useState)(3);(0,r.useEffect)(()=>{t.playerName&&0!==t.questions.length||e.push("/")},[t.playerName,t.questions.length,e]);let v=t.questions[t.currentQuestionIndex],I=(t.currentQuestionIndex+1)/t.selectedQuestions*100,y=(()=>{switch(t.selectedQuestions){case 5:return 20;case 10:default:return 10;case 20:return 5}})();return v?(0,n.jsxs)(n.Fragment,{children:[p&&(0,n.jsx)("div",{className:"countdown-overlay",children:(0,n.jsx)("div",{className:"countdown-number",children:S})}),(0,n.jsx)("section",{id:"screen-quiz",className:"screen active",children:(0,n.jsx)("div",{className:"container",children:(0,n.jsxs)("div",{className:"glass-panel",children:[(0,n.jsxs)("div",{className:"quiz-header",children:[(0,n.jsx)("div",{className:"quiz-info",children:(0,n.jsxs)("span",{className:"quiz-counter",children:["Question ",(0,n.jsx)("span",{id:"current-question",children:t.currentQuestionIndex+1})," / ",(0,n.jsx)("span",{id:"total-questions",children:t.selectedQuestions})]})}),(0,n.jsx)("div",{className:"progress-bar",children:(0,n.jsx)("div",{className:"progress-fill",id:"progress-fill",style:{width:"".concat(I,"%")}})})]}),(0,n.jsxs)("div",{className:"question-container",children:[(0,n.jsx)("h3",{className:"question-text",id:"question-text",children:v.question}),(0,n.jsx)("div",{className:"answers-grid",id:"answers-grid",children:v.options.map((r,i)=>(0,n.jsx)("button",{className:"answer-btn ".concat(o===i?i===m?"correct":"incorrect":""," ").concat(m===i&&null!==o?"correct":""),onClick:()=>(n=>{if(h||!v)return;g(!0),d(n),f(v.correctAnswer);let r=n===v.correctAnswer,i=t.score;r&&(i=t.score+y,s(e=>({...e,score:e.score+y,correctAnswers:e.correctAnswers+1}))),setTimeout(()=>{let n=t.currentQuestionIndex+1;var r=i;let c=(0,u.PL)();if(c){let e=n/t.selectedQuestions*100;(0,u.i1)(c.id,e,n,r)}n%3==0&&n<t.selectedQuestions?(t=>{x(!0),N(3);let n=3,r=setInterval(()=>{--n>0?N(n):(clearInterval(r),s(e=>({...e,currentQuestionIndex:t})),e.push("/join/game"))},1e3)})(n):n>=t.selectedQuestions?(s(e=>({...e,currentQuestionIndex:n})),(()=>{let s=(0,u.PL)();s&&(0,u.i1)(s.id,100,t.selectedQuestions,t.score),l(),e.push("/join/results")})()):(s(e=>({...e,currentQuestionIndex:n})),d(null),f(null),g(!1))},1500)})(i),disabled:h,children:r},i))})]})]})})})]}):null}},5393:(e,t,s)=>{Promise.resolve().then(s.bind(s,1061))},5620:(e,t,s)=>{"use strict";s.d(t,{B3:()=>l,Ip:()=>a,PL:()=>S,PN:()=>N,S0:()=>o,Sx:()=>v,TT:()=>i,aH:()=>x,bX:()=>m,bj:()=>f,hP:()=>c,i1:()=>g,tY:()=>d,zf:()=>p});let n="cosmicquest_game_session",r="cosmicquest_session_players";function i(e,t,s,i,c,u){let l={gameCode:e,hostName:t,topicId:s,topicTitle:i,selectedQuestions:c,difficulty:u,status:"waiting",createdAt:Date.now(),startedAt:null};return localStorage.setItem(n,JSON.stringify(l)),localStorage.setItem(r,JSON.stringify([])),l}function c(){let e=localStorage.getItem(n);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}function u(e){let t=c();if(!t)return null;let s={...t,...e};return localStorage.setItem(n,JSON.stringify(s)),s}function l(){return u({status:"playing",startedAt:Date.now()})}function a(){return u({status:"finished"})}function o(){localStorage.removeItem(n),localStorage.removeItem(r)}function d(e){let t=c();return t&&t.gameCode===e?t:null}function m(e,t,s){let n=d(e);if(!n)return null;let r=f(),i=r.find(e=>e.username===t);if(i)return i.spacecraft=s,h(r),i;let c={id:"player-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),username:t,spacecraft:s,progress:0,questionsAnswered:0,totalQuestions:n.selectedQuestions,score:0,isHost:!1,joinedAt:Date.now()};return r.push(c),h(r),c}function f(){let e=localStorage.getItem(r);if(!e)return[];try{return JSON.parse(e)}catch(e){return[]}}function h(e){localStorage.setItem(r,JSON.stringify(e))}function g(e,t,s,n){let r=f(),i=r.findIndex(t=>t.id===e);-1!==i&&(r[i]={...r[i],progress:t,questionsAnswered:s,score:n},h(r))}function p(e,t){let s=f(),n=s.findIndex(t=>t.id===e);-1!==n&&(s[n].spacecraft=t,h(s))}function x(){let e=c();return null!==e&&"playing"===e.status}function S(){let e=localStorage.getItem("cosmicquest_current_player");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}function N(e){localStorage.setItem("cosmicquest_current_player",JSON.stringify(e))}function v(){localStorage.removeItem("cosmicquest_current_player")}}},e=>{e.O(0,[441,255,358],()=>e(e.s=5393)),_N_E=e.O()}]);